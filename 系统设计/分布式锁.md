# 分布式

## 分布式锁
常用的分布式锁有三个：
1. 数据库
2. redis等缓存数据库
3. zookeeper。

redis最效率最快
zookeeper一致性最高
数据库慢，比较有保障，能不用一般不用


其中最好的是zookeeper

分布式锁的：https://blog.csdn.net/qq_32924343/article/details/79814133
    ```
      分布式锁的几个要求：
        1. 可重入的
        2. 保证单点，也即锁只能被同一个机器的同一个线程获取
        3. 不会超时
        4. 非阻塞式
    ```
## 分布式事务
1. 接口幂等性，超时等原因太多
2. 重要接口全部提过回滚接口
3. 单独的服务用于检测系统数据
4. 接口执行结果提供mq回馈
5. 延时不要求的，通过mq方式实现部分接口，同时提供mq消息反馈
6. 如果mq消息失败，采用数据库记录mq消息体，防止消息体被压缩或者阻塞其他
7. 如果采用mq，需要考虑顺序性，kafka的顺序性是全部发到一个partion
